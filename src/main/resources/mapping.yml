topics:
  'cr_course':
    events:
      - filter: "$"
        tables:
          'course':
            entities:
              root:
                from: $
                nondated:
                  courseId:
                    type: int
                    from: $.courseId
                    primaryKey: true
                  courseLevel:
                    type: varchar(12)
                    from: $.courseLevel
          'taughtBy':
            flatMapped:
              from: $.taughtBy
              filter: "$[?(@.personId != null)]"
              nondated:
                courseId:
                  type: int
                  fromRoot: $.courseId
                  primaryKey: true
                personId:
                  type: int
                  from: $.personId
                  primaryKey: true
                  entityId: true
  'cr_person':
    events:
      - filter: "$"
        tables:
          'person':
            entities:
              root:
                from: $
                nondated:
                  personId:
                    type: int
                    from: $.personId
                    primaryKey: true
                  professor:
                    type: bit
                    from: $.professor
                  student:
                    type: bit
                    from: $.student
                  hasPosition:
                    type: bit
                    from: $.hasPosition
                  inPhase:
                    type: bit
                    from: $.inPhase
                  yearsInProgram:
                    type: varchar(12)
                    from: $.yearsInProgram
          'advisedBy':
            flatMapped:
              from: $.advisedBy
              filter: "$[?(@.personId != null)]"
              nondated:
                advisorPersonId:
                  type: int
                  from: $.personId
                  primaryKey: true
                  entityId: true
                adviseePersonId:
                  type: int
                  fromRoot: $.personId
                  primaryKey: true
